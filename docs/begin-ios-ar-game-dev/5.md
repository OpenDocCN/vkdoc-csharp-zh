# 5.制作 AR 游戏

现在你已经学会了使用 ARKit 的一些基础知识，并且掌握了 Unity，我们将开始制作一个 AR 游戏。在这个过程中，我们还将介绍 ARKit 的一些更高级的功能。

## 河豚保龄球游戏

现在是时候创建一个 AR 游戏了。我决定恢复我们在上一本书*中创作的游戏，学习 iOS 游戏开发的 Unity*(2017 年出版)。如果你是少数没有得到这本书的人之一，我们的游戏是 Fugu Bowl，这是一个适用于 iOS 设备的小型保龄球游戏。在我们的上一本书中，我们使用了 JavaScript，但对于 AR 版本，我们将使用 C#。虽然 JavaScript 是一种很棒的编程语言，但如果你打算继续使用 Unity，那么学习 C#将会重要得多，也有价值得多。如果你不知道如何用 C#编程，我强烈推荐你学习这种语言。这本书的重点是学习制作一个 AR 游戏，我就不重点教怎么用 C#编程了。然而，我在代码中加入了注释，试图帮助不熟悉 C#的人理解代码要做什么。

## 创建新场景

由于我们已经下载并安装了 Unity ARKit 包到我们的 AR 项目中，让我们继续使用它。通常，我更喜欢(也推荐)为每个新游戏创建一个新项目。然而，由于这将涉及到下载 Unity ARKit 包，这次我们就不做了。

要创建一个新场景，从主菜单中选择文件➤新场景(图 [5-1](#Fig1) )。使用快捷键(⌘-N)可能更有效，我还将为那些喜欢使用快捷键的读者提供常用命令的快捷键。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig1_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig1_HTML.jpg)

图 5-1

创建新场景

让我们保存我们的场景。从主菜单中选择文件➤将场景另存为(图 [5-2](#Fig2) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig2_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig2_HTML.jpg)

图 5-2

将场景另存为

你将看到另存为对话框(图 [5-3](#Fig3) )并输入我们场景的名称。我已经决定将这个游戏命名为 Fugu BowlAR(看到我在那里做了什么吗？).

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig3_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig3_HTML.jpg)

图 5-3

将场景保存为 Fugu BowlAR

选择“保存”以保存该场景。您会注意到该文件现在保存在 Assets 文件夹中。我相信在软件开发中，最好是组织良好的(有些人可能称之为强迫症)。因此，这个场景可能应该保存在场景文件夹中。在项目文件夹中，选择河豚鲍拉尔场景(图 [5-4](#Fig4) )并将其拖动到场景文件夹中(图 [5-5](#Fig5) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig5_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig5_HTML.jpg)

图 5-5

场景项目文件夹中的 Fugu BowlAR

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig4_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig4_HTML.jpg)

图 5-4

在项目资源文件夹中选择 Fugu BowlAR 场景

### 创建 AR 资产

你可能记得创建我们的惊人的立方体，我们将重复这个过程。首先，我们要创造一个惊人的保龄球。我们可能会在网上或 Unity Asset Store 中找到一个非常棒的游戏，但我非常喜欢在我有时间但没有预算支付给比我更有艺术天赋的人来为我创建自己的游戏资产(我的艺术天赋非常有限)。

在主菜单中，选择游戏对象➤ 3D 对象➤球体(图 [5-6](#Fig6) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig6_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig6_HTML.jpg)

图 5-6

场景中的球体游戏对象

让我们改变一些属性。第一个任务是重命名这个游戏对象。我将把这个游戏命名为 BowlingBall。选择球体游戏对象，在检查器中，选择游戏对象名称(图 [5-7](#Fig7) )并选择当前文本，键入我们的新名称(图 [5-8](#Fig8) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig8_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig8_HTML.jpg)

图 5-8

球体游戏对象重命名为保龄球

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig7_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig7_HTML.jpg)

图 5-7

选定的球体游戏对象

### 变换保龄球

您可能还记得，在 Unity 中，我们使用公制。这意味着我们的保龄球游戏对象将是 1 米，1 米，1 米。我没有花很多时间打保龄球，但即使我知道这将是一个非常大的保龄球。让我们调整它的大小(缩放)并将保龄球放在原点(0，0，0)。

首先，选择刻度并输入以下刻度设置 0.25、0.25、0.25。现在让我们将变换位置设置为 0，0，0(图 [5-9](#Fig9) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig9_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig9_HTML.jpg)

图 5-9

重新定位和重新缩放保龄球

### 添加刚体

当我们创建我们的立方体时，它漂浮在空中，这很酷。但是当我们希望球在真实世界的地板上滚动时，我们需要添加一个刚体组件。刚体组件提供刚体模拟，模拟不变的形状如何对力和碰撞做出反应。我们希望我们的保龄球游戏对象对重力做出反应(保持在地板上，我们还将对它施加一些力，使它移动)。最后，我们希望它与我们的保龄球瓶相撞。因此，我们需要添加一个刚体组件到我们的保龄球。

在层级视图中选择 BowlingBall，在检查器中，选择添加组件(图 [5-10](#Fig10) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig10_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig10_HTML.jpg)

图 5-10

添加组件

在“添加组件”菜单中，有一个搜索栏。在搜索栏中，键入 Rigid 并选择刚体组件(图 [5-11](#Fig11) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig11_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig11_HTML.jpg)

图 5-11

搜索刚体组件

刚体组件的默认设置非常好，但是 1 千克的质量对于保龄球来说有点轻。让我们把质量设为 5，因为 5 公斤，对于一个保龄球来说是合适的。其他的设置现在很好(但是我们可能需要在测试后调整这些设置)。图 [5-12](#Fig12) 显示保龄球的设置。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig12_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig12_HTML.jpg)

图 5-12

保龄球刚体设置

在图 [5-12](#Fig12) 中，我们可以看到我们的保龄球有一个组件叫做球体碰撞器。碰撞器组件为我们的游戏对象提供了碰撞形状。在这种情况下，当我们创建我们的球体游戏对象时，还添加了一个球体形状的碰撞器。碰撞器组件将决定一个游戏对象将在什么点碰撞。但是，碰撞器并不决定它将如何碰撞(反弹、滑动或根本不移动)。为了设置游戏对象如何对碰撞做出反应，我们需要添加一个物理材质。要获得物理材料，我们需要从 Unity Store 下载 Unity Standard Assets 包(我们可以在第一次创建它时将其添加到我们的项目中)。资产商店中还有其他可用的物理材料，其中一些是免费的，其他的则需要付费。

### 打开资产商店

选择资产存储视图选项卡以显示资产存储(图 [5-13](#Fig13) )。在搜索栏中，键入标准资产。如果您想添加过滤器以仅显示自由资产，这将限制搜索结果(图 [5-14](#Fig14) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig14_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig14_HTML.jpg)

图 5-14

搜索标准资产(免费)

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig13_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig13_HTML.jpg)

图 5-13

Unity 资产商店视图

选择标准资产包，这将打开该资产包的信息屏幕(图 [5-15](#Fig15) )。选择 Install(或 Update，如果您在创建项目时已经安装了它)。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig15_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig15_HTML.jpg)

图 5-15

包裹信息屏幕

几分钟后(取决于你的下载速度)，Unity 会打开导入 Unity 包菜单(图 [5-16](#Fig16) )。虽然我们不需要所有这些资产，但我们只需选择 Import(我们可以随时删除任何我们不需要或以后不想要的东西)。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig16_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig16_HTML.jpg)

图 5-16

Unity 导入包屏幕

几分钟后，包将被导入，您将在您的项目文件夹中看到一些额外的资产(图 [5-17](#Fig17) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig17_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig17_HTML.jpg)

图 5-17

项目文件夹中的 Unity 标准资产包

如果我们选择 PhysicsMaterials 文件夹，我们可以看到现在我们有一系列物理材料可供选择(图 [5-18](#Fig18) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig18_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig18_HTML.jpg)

图 5-18

Unity 标准资产包物理材料文件夹

### 物理材料

标准资产包为我们提供了一个物质基础。然而，它们都没有为我们的保龄球提供最好的物理材料。现在，让我们使用木质材料。因为我们可能需要在游戏的另一部分使用这个材料，所以让我们复制它。从主菜单中选择“编辑➤副本”(或 Command+D)。现在在项目文件夹中，选择复制的 PhysicsMaterial (Wood 1)并将其重命名为 Ball(图 [5-19](#Fig19) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig19_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig19_HTML.jpg)

图 5-19

选择球物理材料

现在，在选择保龄球游戏对象和层次结构中，选择球体碰撞器组件中材质属性的属性框旁边的小齿轮，然后选择我们刚刚创建的球物理材质(技术上是复制的)(图 [5-19](#Fig19) )。在“项目”选项卡中，双击“球物理”材质以设置物理属性。将动态摩擦力设置为 1，静态摩擦力设置为 1，弹力设置为 0，摩擦力组合为最大，弹力组合为最小(图 [5-20](#Fig20) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig20_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig20_HTML.jpg)

图 5-20

设置球的物理材质属性

### 创建(临时)平面

如果我们现在测试我们的游戏，我们会看到我们的球掉下来(并且永远不会停止)。虽然，我们将使用真实世界的表面，现在，让我们安装一个临时的平面游戏对象来帮助我们在游戏视图中测试我们的游戏。

从主菜单中，选择游戏对象➤ 3D 对象➤平面(图 [5-21](#Fig21) )。在层次中选择平面，并将其重命名为 Plane(t)。如果你在场景视图中查看，你会注意到该平面已在原点创建，因此，穿过我们的保龄球。让我们重新定位我们的飞机(t)，让它正好位于保龄球的下面(图 [5-22](#Fig22) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig22_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig22_HTML.jpg)

图 5-22

平面(t)变换设置

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig21_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig21_HTML.jpg)

图 5-21

创建一个平面

如果我们看场景视图，平面(t)和保龄球的颜色是相同的。让我们改变飞机(t)的颜色。在项目文件夹中搜索素材(图 [5-23](#Fig23) ，你会看到有几个我们可以使用的资产；我将为飞机(t)使用球材料。有几种方法可以改变材质属性，但最简单的是在场景视图中选择球体材质并将其拖放到平面(t)上(图 [5-24](#Fig24) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig24_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig24_HTML.jpg)

图 5-24

球料所在的平面(t)

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig23_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig23_HTML.jpg)

图 5-23

搜索球料

现在，让我们添加一些大头针(或彩虹糖，取决于你来自哪里)。如果我们在资产商店中寻找保龄球瓶，我们会发现唯一的选择是有偿资产。然而，我们在谷歌的好朋友在 [`https://poly.google.com/`](https://poly.google.com/) 上有一个奇妙的 AR 和 VR 资产库。用你最喜欢的浏览器打开这个站点，搜索大头针。你会发现有几个不错的选择(图 [5-25](#Fig25) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig25_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig25_HTML.jpg)

图 5-25

在 Google Poly 中搜索图钉

选择您要使用的 Pins 我将使用谷歌保利的保龄球瓶。如果我们检查许可证，我们可以看到它在知识共享许可下是可用的，这允许我们使用它(更多细节见 [`https://creativecommons.org/`](https://creativecommons.org/) )。选择下载链接，并选择 OBJ 下载此图像。当你在谷歌聚合页面上的时候，查看一些令人惊奇的内容。

### 将 OBJ 文件导入 Unity

文件下载完成后，打开保存文件的文件夹，右键单击(或双击)解压文件夹(图 [5-26](#Fig26) )。在文件夹中，你会看到有一个 OBJ 文件(这是我们需要的)。现在在 Unity 中，从主菜单“资产”“➤”“导入新资产”,浏览到带有 Pin OBJ 文件的解压缩文件夹，选择 OBJ 文件，然后选择“导入”。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig26_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig26_HTML.jpg)

图 5-26

解压缩 Bowling_Pin.obj 文件夹

Unity 完成导入该资产后，它将出现在资产文件夹中(图 [5-27](#Fig27) )。我将创建一个新文件夹来保存我可能会用到的任何导入的图片。如果在“资产”文件夹中没有找到该资产，请确保在“项目视图”选项卡中进行搜索。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig27_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig27_HTML.jpg)

图 5-27

资产文件夹中的 Bowling_Pin 资产

### 创建新的项目文件夹

要在项目视图中创建新文件夹，在项目文件夹中右击并从菜单中选择并选择创建➤文件夹(图 [5-28](#Fig28) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig28_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig28_HTML.jpg)

图 5-28

创建新的项目文件夹

Unity 将在 Assets 项目文件夹中创建文件夹，现在我们需要命名它并将我们的 Bowling_Pin 资产拖放到这个文件夹中。我将把这个文件夹命名为艺术资产(图 [5-29](#Fig29) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig29_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig29_HTML.jpg)

图 5-29

包含 Bowling_Pin 资源的“艺术资源”文件夹

### 将保龄球瓶添加到场景中

选中 Bowling_Pin 资产，将其拖动到层次(或场景视图)(图 [5-30](#Fig30) )。你会注意到，我们再次需要转换这个游戏对象的位置和比例。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig30_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig30_HTML.jpg)

图 5-30

层次结构中的保龄球瓶

### 变换 Bowling_Pin 和 BowlingBall 的设置

让我们首先缩放我们的 Bowling_Pin，因为它当前设置为 1，1，1 的比例。然而，正确的尺寸是 121 毫米宽(最宽处)和 380 毫米高。让我们将 Bowling_Pin 缩放到 0.4，0.4，0.4。这不是完美的比例，但看起来很好。让我们也按相对比例缩放保龄球。根据维基百科，保龄球的周长可以在 67.83 厘米和 68.59 厘米之间，直径在 21.59 厘米到 21.83 厘米的范围内。让我们将保龄球级别设置为 0.1，0.1，0.1。这不是完全成比例的，但现在已经足够好了。图 [5-31](#Fig31) 显示我的保龄球在我的保龄球瓶旁边。(在我看来)它们看起来相当不错。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig31_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig31_HTML.jpg)

图 5-31

重新缩放保龄球和保龄球瓶的游戏视图

### 向 Bowling_Pin 添加刚体

我们将遵循同样的过程添加刚体和物理材料到保龄球瓶，就像我们处理保龄球一样。在层级中选择 Bowling_Pin，在检查器中选择添加组件，搜索并添加一个刚体组件(图 [5-32](#Fig32) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig32_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig32_HTML.jpg)

图 5-32

带有刚体组件的 Bowling_Pin 游戏对象

### 向 Bowling_Pin 添加碰撞器

如果我们看看 Bowling_Pin 的检查员，你会注意到没有碰撞器。这是因为它没有配备碰撞器，因为它是非凸形的。我们要添加一个对撞机，这样我们就可以添加一种物理材料。选中 Bowling_Pin，在检查器中选择添加组件并搜索网格(图 [5-33](#Fig33) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig33_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig33_HTML.jpg)

图 5-33

搜索网格碰撞器组件

现在，选择并添加网格碰撞器组件。网格碰撞器将使我们能够创建一个包围游戏对象的网格。在我们刚刚添加的网格碰撞器组件中，有一个属性框供我们设置想要使用的网格类型。网格碰撞器组件使我们能够添加凸形网格(圆柱体、立方体、球体或平面)。因为我们的 Bowling_Pin 最接近圆柱体形状，所以让我们搜索一个圆柱体网格并将其添加到 Bowling_Pin 游戏对象中。选择网格碰撞器网格设置属性框右边的小齿轮，搜索圆柱体(图 [5-34](#Fig34) )。选择圆柱体网格，将其设置为网格碰撞器的形状(图 [5-35](#Fig35) )。还要注意，我已经将刚体组件设置为运动学组件。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig35_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig35_HTML.jpg)

图 5-35

将圆柱体网格设置为网格碰撞器

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig34_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig34_HTML.jpg)

图 5-34

搜索圆柱体网格

### 将物理材质添加到保龄球瓶

就像我们为保龄球所做的一样，我们需要添加一个物理属性来设置保龄球瓶如何对碰撞做出反应。由于保龄球瓶的物理属性类似于保龄球，让我们复制球的物理材质，并将其重命名为 bowling pin，并更改设置。

首先，选择并复制球物理材质，并将其命名为 BowlingPin(图 [5-36](#Fig36) )。选择 BowlingPin PhysicsMaterial 并将设置更改为以下内容；动摩擦= 1，静摩擦= 1，弹性= 0.5，摩擦结合=最大，弹跳结合=最小(图 [5-37](#Fig37) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig37_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig37_HTML.jpg)

图 5-37

BowlingPin 物理材质设置

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig36_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig36_HTML.jpg)

图 5-36

保龄球瓶的物理材料

现在将 BowlingPin PhysicsMaterial 添加到 BowlingPin 游戏对象网格碰撞器中(图 [5-38](#Fig38) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig38_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig38_HTML.jpg)

图 5-38

将 BowlingPin 物理材质设置为材质

### 让保龄球滚动

为了让我们的 Bowling_Ball 根据玩家的输入滚动，我们需要创建一个脚本。正如我已经指出的，这不是一本介绍性的编程书籍，所以我不会花太多时间去探究每一行代码的目的。可能有一些我认为值得注意的重要代码部分，我将在脚本中包含注释来解释这些代码行的目的。让我们首先创建一个文件夹来保存我们所有的脚本。在项目视图中，单击鼠标右键并选择“创建➤文件夹”。让我们给这个脚本命名(图 [5-39](#Fig39) )。您可能希望将此文件夹命名为非常有趣或酷的东西，但是使用文件命名约定是一种很好的做法，这样，如果其他人需要编辑或修改您的游戏，他们可以很容易地确定在项目中的何处可以找到资源。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig39_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig39_HTML.jpg)

图 5-39

脚本文件夹

现在，我们将创建一个脚本来测试 Unity 中的用户输入。因此，我们将让保龄球游戏对象根据键盘(或鼠标)输入移动。我们稍后将更改这一点，以便输入基于触摸、点击或滑动。在层次结构中，选择我们的保龄球游戏对象，然后选择添加组件。在添加组件中，选择新脚本(图 [5-40](#Fig40) )。首先，让我们将这个脚本命名为 PlayerController，并选择 Create and Add。这个选项使我们能够创建脚本并将其添加到保龄球游戏对象中。Unity 会将该脚本放在资产文件夹中。我们需要选择并移动(拖放)这个脚本到我们的脚本菜单(图 [5-41](#Fig41) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig41_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig41_HTML.jpg)

图 5-41

添加到脚本文件夹中的 PlayerController 脚本

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig40_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig40_HTML.jpg)

图 5-40

添加新的脚本组件

### 编辑 PlayerController 脚本

现在让我们编辑 PlayerController 脚本。如果选择 PlayerController 脚本，可以在检查器中看到该资源的代码。让我们编辑这段代码。双击 PlayerController 脚本，这将打开您的默认 IDE。我用的是 Visual Studio。输入如下代码，如清单 [5-1](#PC1) 所示。

```cs
using UnityEngine;
using System.Collections;
public class PlayerController : MonoBehaviour {
    public float speed;
    private Rigidbody rb;
    void Start ()
    {
        rb = GetComponent<Rigidbody>();
    }
    void FixedUpdate ()
    {
        float moveHorizontal = Input.GetAxis ("Horizontal");
        float moveVertical = Input.GetAxis ("Vertical");
        Vector3 movement = new Vector3 (moveHorizontal, 0.0f, moveVertical);
        rb.AddForce (movement * speed);
    }
}

Listing 5-1The PlayerController Script

```

现在我们准备看看我们的代码是否有效。如果我们运行并测试我们的游戏，当我们按下任一箭头键时，保龄球会向任一方向移动(这很好，因为我们只需要球向一个方向移动)。但是，你会注意到 Bowling_Pin 上的碰撞器太大了，碰撞不真实。现在，我们可以编辑这个碰撞器，但是我们要创建我们自己的碰撞器。

### 创造我们自己的对撞机

为了创建我们自己的碰撞器，我们将使用一点游戏设计魔法(也称为伪装)。为此，在层级中选择 Bowling_Pin 游戏对象，并在网格碰撞器组件中选择小齿轮，右键单击并移除当前碰撞器(图 [5-42](#Fig42) )。现在从主菜单中，选择游戏对象➤ 3D 对象➤胶囊(图 [5-43](#Fig43) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig43_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig43_HTML.jpg)

图 5-43

创建 3D 胶囊游戏对象

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig42_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig42_HTML.jpg)

图 5-42

添加到脚本文件夹中的 PlayerController 脚本

你会注意到我们的胶囊游戏对象有点大，因此，我们需要改变比例。还要注意，太空舱有自己的碰撞器。在图 [5-44](#Fig44) 中，我已经变换了比例和位置，所以它和 Bowling_Pin 的高度和宽度差不多。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig44_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig44_HTML.jpg)

图 5-44

重新缩放和重新定位的胶囊

现在我们在胶囊中加入一种物理材料，这样它就能对保龄球的力量做出反应。现在，让我们使用 BowlingPin 物理材料。选中胶囊，在检查器中，选择材质属性框旁边的小齿轮，右键单击并添加 BowlingPin PhysicsMaterial(图 [5-45](#Fig45) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig45_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig45_HTML.jpg)

图 5-45

添加 BowlingPin 物理材质

选中胶囊游戏对象，让我们给它起一个有意义的名字。我选 BowlingPinCollider。

现在我们已经移动了 BowlingPinCollider，使它完全覆盖 Bowling_Pin 游戏对象，下一步是使它对玩家不可见。要使 BowlingPinCollider 游戏对象对玩家不可见，在层级中选择 BowlingPinCollider 游戏对象，并在检查器的网格渲染器组件中，选择右侧的齿轮并选择移除组件(图 [5-46](#Fig46) )。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig46_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig46_HTML.jpg)

图 5-46

移除网格渲染器组件

### 记住父母

你可能还记得在这一章的前面，我讨论了软件开发中的父母和孩子。我们将使保龄球瓶成为保龄球瓶碰撞器的子代。这样，保龄球瓶碰撞器发生的事情也会发生在保龄球瓶上。

### 成为父母

成为父母是我一生中最激动人心也最令人生畏的经历之一。幸运的是，Unity 使得创建一个父游戏对象的过程不那么令人生畏(可能也不那么令人兴奋)。要使我们的 BowlingPinCollider 成为 Bowling_Pin 游戏对象的父对象，我们只需将 Bowling_Pin 游戏对象拖动到 BowlingPinCollider，它将成为 BowlingPinCollider 的子对象(图 [5-47](#Fig47) )。要是生活有那么简单就好了。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig47_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig47_HTML.jpg)

图 5-47

BowlingPinCollider 作为 Bowling_Pin 的父级

现在让我们测试我们的工作，看看我们的碰撞器是否做了它应该做的。咳，我的对撞机工作了(图 [5-48](#Fig48) )。但是 BowlingPinCollider 父代和子代 Bowling_Pin 仍然没有倒下。老实说，这很大程度上反映了我在现实生活中的保龄球能力。然而，我认为如果玩家不能打翻保龄球瓶，他们会有点沮丧。所以，让我们做一些改变，使它更真实一点。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig48_HTML.jpg](img/460089_1_En_5_Chapter/460089_1_En_5_Fig48_HTML.jpg)

图 5-48

碰撞的游戏视角

### 使保龄球瓶翻倒

如果你的保龄球瓶没有倒下，检查每个游戏物体上的刚体组件。在我的设置中，我已经将保龄球的刚体组件的质量设置为 5(即保龄球为 5 kg)。我已经把保龄球瓶设定为 1 公斤。从技术上讲，保龄球瓶应该重 1.6 公斤。因此，我将保留我的设置。如果你的保龄球没有让保龄球瓶倒下，试着调整重量。玩家永远不会亲自捡起它们，也永远不会知道确切的重量。另外，在游戏设计中，过分强调现实有时很有趣。

![img/460089_1_En_5_Chapter/460089_1_En_5_Fig49_HTML.png](img/460089_1_En_5_Chapter/460089_1_En_5_Fig49_HTML.png)

图 5-49

保龄球和保龄球瓶刚体组件

## 摘要

在这一章中，我们已经创建了一个新的场景并添加了游戏对象。我们添加了刚体组件和物理材料。我们已经成功地测试了我们的游戏，看看它是否能在游戏视图中工作。在下一章中，我们将在 AR 中测试游戏，看看它看起来如何。